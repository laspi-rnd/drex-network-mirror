version: '2.1'
services:
  test-node-1:
    user: root
    container_name: test-node-1
    volumes:
      - ../node/besu-1/data:/opt/besu/data
      - ../genesis:/opt/besu/genesis
    image: hyperledger/besu:24.5.2-amd64
    entrypoint:
      - /bin/bash
      - -c
      - besu --data-path=data --genesis-file=genesis/genesis.json --bootnodes=enode://1a7d51f80d2f0737a8b8c8b83bee20fadbf7103bed65bbcb014533fcd4ac5f91b765a440d980b40276863ebd87005c98b0adbf85d78913d8bf0d38eb277a2460@172.20.0.2:30303 --rpc-http-enabled --rpc-http-api=ETH,NET,QBFT --host-allowlist="*" --rpc-http-cors-origins="all"
    ports:
      - "8546:8545"
      - "30304:30303"
    networks:
      test_network:
    restart: always

  test-node-2:
    user: root
    container_name: test-node-2
    volumes:
      - ../node/besu-2/data:/opt/besu/data
      - ../genesis:/opt/besu/genesis
    image: hyperledger/besu:24.5.2-amd64
    entrypoint:
      - /bin/bash
      - -c
      - besu --data-path=data --genesis-file=genesis/genesis.json --bootnodes=enode://1a7d51f80d2f0737a8b8c8b83bee20fadbf7103bed65bbcb014533fcd4ac5f91b765a440d980b40276863ebd87005c98b0adbf85d78913d8bf0d38eb277a2460@172.20.0.2:30303 --rpc-http-enabled --rpc-http-api=ETH,NET,QBFT --host-allowlist="*" --rpc-http-cors-origins="all"
    ports:
      - "8547:8545"
      - "30305:30303"
    networks:
      test_network:
    restart: always
    
  test-node-3:
    user: root
    container_name: test-node-3
    volumes:
      - ../node/besu-3/data:/opt/besu/data
      - ../genesis:/opt/besu/genesis
    image: hyperledger/besu:24.5.2-amd64
    entrypoint:
      - /bin/bash
      - -c
      - besu --data-path=data --genesis-file=genesis/genesis.json --bootnodes=enode://1a7d51f80d2f0737a8b8c8b83bee20fadbf7103bed65bbcb014533fcd4ac5f91b765a440d980b40276863ebd87005c98b0adbf85d78913d8bf0d38eb277a2460@172.20.0.2:30303 --rpc-http-enabled --rpc-http-api=ETH,NET,QBFT --host-allowlist="*" --rpc-http-cors-origins="all"
    ports:
      - "8548:8545"
      - "30306:30303"
    networks:
      test_network:
    restart: always

networks:
  test_network:
    external: true